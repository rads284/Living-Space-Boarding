<!doctype html>
<!-- Website template by freewebsitetemplates.com -->
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Leave Request</title>
	<link rel="stylesheet" href="css/style.css" type="text/css">
	<script src="js/mobile.js" type="text/javascript"></script>
</head>
<script>
 var obj =
    {
        xhr: new XMLHttpRequest(),
        check: function(){
                var from = document.getElementById("date1").required;
                console.log(from.value);
                var to = document.getElementById("date2").required;
                            var today = new Date();
                var dd = String(today.getDate()).padStart(2, '0');
                var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
                var yyyy = today.getFullYear();

                today = yyyy + '-' + mm + '-' + dd;
                console.log("today:",today);
//                console.log((today < from));

            function stringToDate(str){
            var date = str.split("-"),
                m = date[1],
                d = date[2],
                y = date[0];
            return (new Date(y + "-" + m + "-" + d))
                }
            from = stringToDate(from.value);
            to = stringToDate(to.value);
            today = stringToDate(today);
            console.log(from, to, today);
            console.log("Comparing from and to:",from < to);
            console.log("Comparing to and today:",to > today);
            console.log("Comparing from and today:",from > today);
            if(from < today){
                alert("Please enter a valid From date");
                document.getElementById("date1").value = '';
            }
            if(to < today){
                alert("Please enter a valid To date");
                document.getElementById("date2").value = '';
            }
             var sid = document.getElementById("sid").required;


                if((sid.value < 0) ||( sid.value >99))
                    {
                    alert("Please enter a valid Student Id");
                    sid.value = '';
                    }
                var reason = document.getElementById("reason").required;

                //console.log(this);
                obj.xhr.onreadystatechange=this.showMsg;
                obj.xhr.open("POST", "http://localhost:5000/notify_parent", true);//asynchronous
                //don't add this!! This and Post should not be set together, post will set the header automatically!! obj.xhr.setRequestHeader("Content-type", " application/x-www-form-urlencoded");
                var fd = new FormData();
                console.log(from.value,to.value,reason.value)
                fd.append("from", from.value);
                fd.append("to", to.value);
                fd.append("reason", reason.value);
                fd.append("sid", sid.value);
                obj.xhr.send(fd);

            },
        showMsg : function(){
                if(this.readyState == 4 && this.status == 200){
                    document.getElementById("stat").innerHTML = this.responseText;
                }
        },


    displayForm : function(){

    clr = document.getElementById("CLR");
    clr.disabled = true;
    br0 = document.createElement("br");
    var t0 = document.createTextNode("Student ID");

    var sid = document.createElement("input"); //input element, text
    sid.setAttribute('type',"text");
    sid.setAttribute('id',"sid");
    sid.setAttribute('required',true);
    sid.required = true;
    br4 = document.createElement("br");
    var t1 = document.createTextNode("From");
    var date1 = document.createElement("input"); //input element, text
    date1.setAttribute('type',"date");
    date1.setAttribute('id',"date1");
    date1.setAttribute('required',true)
    br1 = document.createElement("br");
    var t2 = document.createTextNode("   To");
    var date2 = document.createElement("input"); //input element, text
    date2.setAttribute('type',"date");
    date2.setAttribute('id',"date2");
    date2.setAttribute('required', 1);

    br2 = document.createElement("br");


    var t3 = document.createTextNode("Reason");
    var reason = document.createElement("input"); //input element, text
    reason.setAttribute('type',"text");
    reason.setAttribute('id',"reason");
    reason.required  = true;
    br3 = document.createElement("br");

    var submit = document.createElement("input"); //input element, Submit button
    submit.setAttribute('type',"submit");
    submit.setAttribute('value',"Submit");
    submit.addEventListener("click", this.check);
    document.body.appendChild(br0);
    document.body.appendChild(t0);
    document.body.appendChild(sid);
    document.body.appendChild(br4);
    document.body.appendChild(t1);
    document.body.appendChild(date1);
    document.body.appendChild(t2);
    document.body.appendChild(date2);
    document.body.appendChild(br2);
    document.body.appendChild(t3);
    document.body.appendChild(reason);
    document.body.appendChild(br3);
    document.body.appendChild(submit);

},

}


</script>



<body>
	<div id="page">
		<div id="header">
			<div id="navigation">
				<span id="mobile-navigation">&nbsp;</span>
									<ul id="menu">
										<li class="selected">
											<a href="home.html">Home</a>
										</li>
										<li>
											<div class="dropdown">
												<a>Leave ▽</a>
												<div class="dropdown-content" >
																<hr>
																<a href="leaverequest.html" style="margin-top:30px;margin:20px;">Leave Request</a> <br> <hr>
																<a href="leaveapproval.html"  style="margin:20px;"> Leave Approval</a>
																<hr>
												</div>
											</div>
										</li>
										<li>
											<div class="dropdown2">
													<a>Attendance ▽</a>
													<div class="dropdown-content2" >
																	<hr>
																	<a href="markattendance.html" style="margin-top:30px;margin:20px;">Mark Attendance</a> <br> <hr>
																	<a href="viewattendance.html"  style="margin:20px;">View Attendance</a>
																	<hr>
													</div>
											</div>
										</li>
										<li>
											<a href="index.html">SIGN OUT</a>
										</li>
									</ul>
			</div>
		</div>
		<div id="body" class="leave">
			<div>

				<h4>Enter Leave Request Details:</h4><br><br>
				<form id="leave_req_form" action="home.html">
					<p>Student ID</p>
					<input type="text" name="username"  onfocus="this.select()" > <br>
					  <p>From</p>
					 <input type="date" class="datetype" name="startdate"  value="2019-11-22">
						<p> To </p>
						<input type="date" class="datetype" name="enddate"  value="2019-11-22"><br><br>
						<p> Reason:</P>
						<textarea name="reason" rows="7" cols="50" name="comment" form="leave_req_form"></textarea>
						<br><br><br><br>
						<input onclick = "location.replace('home.html')" type="submit" value="Submit" id="submit">


					<br><br><br>
				</form>
			</div>
		</div>
		<div id="footer">
			<div>
				<div class="connect">
					<a href="https://twitter.com/home" class="twitter">twitter</a>
					<a href="http://facebook.com" class="facebook">facebook</a>
					<a href="http://gmail.com" class="googleplus">googleplus</a>
					<a href="http://pinterest.com" class="pinterest">pinterest</a>
				</div>
				<p>&copy; 2019 by EKBAP. All rights reserved.</p>
			</div>
		</div>
	</div>
</body>
</html>
